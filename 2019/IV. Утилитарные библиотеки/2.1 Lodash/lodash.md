Lodash & Axios. Конспект лекции
===============================

### Слайд 1

Цель и задачи лекции
--------------------

### Слайд 2

1. Познакомиться и получить общее представление об утилитарных библиотеках:

    - Lodash

    - Axios

2. Получить практические навыки работы с библитеками

План занятия
------------

### Слайд 3

1. Зачем нужны утилитарные библиотеки

2. Библиотека Lodash

    - История появления библиотеки lodash

    - Какие проблемы lodash решает

    - Возможности библиотеки lodash (примеры использования)

    - Lodash и функциональное программирование

    - Попрактиковаться в использовании lodash

3. Библиотека Axios

    - Познакомиться с библиотекой axios

    - Понять какие проблемы axios решает и какие не решает

    - История появления библиотеки axios

    - Попрактиковаться в использовании axios

    - GET и POST через библиотеку axios (пример с простыми параметрами)

    - Axios interceptors (простой пример как можно менять ответ и делать редирект)

4. Ответы на вопросы

Основная часть занятия
----------------------

Используем демонстрацию презентации

### Слайд 4

+ Утилитарные библиотеки, такие как Lodash и Axios помогают сконцентрироваться на выполнении бизнес задачи, пропуская необходимость проработки деталей реализации

+ Название родилось от английских слов Lower dash. Именно таким символом принято именовать глобальный объект библиотеки. Библиотека использует то же самое имя, которое используется в популярной до недавнего времени библиотеке [Underscore.js](https://underscorejs.org/), но является её логическим продолжением и обладает улучшенными характеристиками.

+ В качестве улучшений функциональности Lodash по сравнению с нативными методами является лучшая переработка их реализации. Поэтому можно считать, что используя Lodash мы добиваемся в том числе цели повышения производительности программ

+ Кроме того, что функции библиотеки оптимизированы по производительности, относительно аналогичных нативных функций, они являются отказоустойчивыми, то есть независимо от предоставленных аргументов не выбрасывают исключений, что позволяет сделать код более последовательным и читаемым.

+ Таким образом, мы добиваемся значительного облегчения кода прикладной программы за счёт переиспользования библиотечных функций

+ Поскольку мы принимаем в качестве факта то, что библиотечные функции являются законченным продуктом с предсказуемым поведением, то у нас нет необходимости проверять работоспособногсть кода, реализуемого этими функциями и есть необходимость лишь тестировать собственный код, в том числе, по частям, используя механизмы библиотечных функций

+ Ввиду того, что за библиотечными функциями мы можем скрывать детали реализации, мы получаем более компактный и читаемый код

+ Кроме того, использование библиотечных функций унифицирует работу с данными в среде различных браузеров, независимо от реализации ими тех или иных нативных функций, как `Array.prototype.includes`, `Object.assign`

### Слайд 5

+ Рассмотрим типы функций, представленные в библиотеке. Функции группируются как по типам данных, с которыми работают, так и по способу работы с данными

+ Кроме того существует дополнительная реализация библиотеки, реализующая работу с данными в стиле функционального программирования

### Слайд 6

+ Функции библиотеки могут быть использованы тремя различными способами:

    - Прямое использование вызовов функций при императивном подходе к программированию. Это традиционный способ вызова функций при императивном программировании

    - Монадические вычисления. Реализация ленивых монадических цепочек вычислений

    - Композиционные вычисления. Определение плана исполнения программы через композицию функций

### Слайд 7

+ Рассмотрим некоторые простые примеры вызова функций библиотеки

### Слайд 8

+ Определим простую задачу для демонстрации функций библиотеки, как задачу возведения в квадрат одного из свойств предоставленного объекта

### Слайд 9

+ Используем императивный подход

### Слайд 10

+ Используем монадический подход, при этом используем функцию `_.prototype.chain` для принудительного использования монадических цепочек при вычислении

### Слайд 11

+ Используем приём композиции функций для определения новой функции, реализующей требуемый функционал

### Слайд 12

+ Понятие о библиотеке Axios

+ Axios -- Promise-based http-клиент для использования как в браузере, так и в nodejs-приложении

+ Основной функционал библиотеки:

    - В среде браузера выполняется XMLHttpRequest

    - В среде ndoe.js выполняется http запрос

    - Реализована поддержка Promise API

    - Есть возможность добавления промежуточной обработки запросов и ответов в том числе и их трансформация

    - Есть возможность прервать выполнение запроса

    - Реализована автоматическая сериализация в JSON

    - Реализована возможность защиты от XSRF-атак н астороне клиента

### Слайд 13

+ Кратко описываем варианты выполнения клиент-серверного запроса со стороны браузера

    - использование нативного `XMLHttpRequest`

    - использование нативного `fetch`

    - использование сервисов, предоставляемых различными фреймворками:

        - `$.ajax` -- jQuery

        - `$http` -- Angular.js

+ Определяем, какие проблемы существуют без использования библиотеки:

    - Зависимость от реализации браузера

    - Ограничения фреймворков

    - Отсутствие единого подхода при использовании клиентского и серверного кода

### Слайд 14

+ Основные варианты вызова
    
    - `axios(config)`

    - `axios(url, config)`

+ Также доступны функции-псевдонимы, например:

    - `axios.request(config)`

    - `axios.get(url[, config])`

    - `axios.post(url[, data[, config]])`

    - а также есть псевдонимы для всех поддерживаемых HTTP-методов

### Слайд 15

+ Схема ответа `(response)`:

```js
({
    // `data` is the response that was provided by the server
    data: {},

    // `status` is the HTTP status code from the server response
    status: 200,

    // `statusText` is the HTTP status message from the server response
    statusText: 'OK',

    // `headers` the headers that the server responded with
    // All header names are lower cased
    headers: {},

    // `config` is the config that was provided to `axios` for the request
    config: {},

    // `request` is the request that generated this response
    // It is the last ClientRequest instance in node.js (in redirects)
    // and an XMLHttpRequest instance the browser
    request: {}
})
```

### Слайд 16

+ Применение параметров конфигурации
    
    - применяются параметры, заданные по умолчанию для библиотеки

    - применяются параметры экземпляра Axios, который может быть создан

    - применяются параметры, заданные в запросе

### Слайд 17

+ Использование интерсепторов

    - Добавление и удаление интерсептора

    - Параметры интерсепторов запроса и ответа

### Слайд 18

+ Пример запроса с интерсепторами

```js
import _ from 'lodash'
import axios from 'axios'

const requestInterceptor = axios.interceptors.request
    .use(config => (console.log('REQUEST CONFIG:', config), config))
  
const responseTransformInterceptor = axios.interceptors.response
    .use(response =>
        _.set(response, 'data', _.isObject(response.data) ? response.data : 'IS NOT JSON')
    )
const responseLogInterceptor = axios.interceptors.response
    .use(response => (console.log('RESPONSE DATA:', response.data), response))

axios.get('https://ya.ru')
    .then(somethingToResolve)
    .catch(somethingToReject)

axios.interceptors.request.eject(requestInterceptor)
axios.interceptors.response.eject(responseTransformInterceptor)
axios.interceptors.response.eject(responseLogInterceptor)
```

### Слайд 19

+ Есть ли вопросы по использованию библиотек?

Литература и ссылки
-------------------

1. [Документация по Lodash](https://lodash.com/docs/4.17.11)

2. [Документация по Axios](https://github.com/axios/axios)

Вопросы для самоконтроля
------------------------

1. Назовите преимущества использования библиотечных функций

2. Какие основные задачи решаются путём использования библиотечных функций

3. Для чего используется библиотека Axios и в чём плюсы её использования
